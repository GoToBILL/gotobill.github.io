<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>무효화 파이프라인</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            zoom: 1.3;
        }
    </style>
</head>
<body class="bg-white p-8">
    <div class="max-w-7xl mx-auto">
        <div class="text-2xl font-bold text-center mb-8 p-3 border-b-2 border-gray-300">
            무효화 파이프라인
        </div>

        <svg viewBox="0 0 1200 450" class="w-full">
            <!-- Step numbers (박스 상단 중앙) -->
            <circle cx="120" cy="30" r="18" fill="#3b82f6" stroke="white" stroke-width="2"/>
            <text x="120" y="37" text-anchor="middle" font-size="16" font-weight="bold" fill="white">1</text>

            <circle cx="480" cy="30" r="18" fill="#16a34a" stroke="white" stroke-width="2"/>
            <text x="480" y="37" text-anchor="middle" font-size="16" font-weight="bold" fill="white">2</text>

            <circle cx="840" cy="30" r="18" fill="#f59e0b" stroke="white" stroke-width="2"/>
            <text x="840" y="37" text-anchor="middle" font-size="16" font-weight="bold" fill="white">3</text>

            <circle cx="840" cy="300" r="18" fill="#a855f7" stroke="white" stroke-width="2"/>
            <text x="840" y="307" text-anchor="middle" font-size="16" font-weight="bold" fill="white">4</text>

            <circle cx="120" cy="300" r="18" fill="#ec4899" stroke="white" stroke-width="2"/>
            <text x="120" y="307" text-anchor="middle" font-size="16" font-weight="bold" fill="white">5</text>

            <!-- 1. Web Server -->
            <rect x="20" y="60" width="200" height="80" fill="#dbeafe" stroke="#3b82f6" stroke-width="3" rx="8"/>
            <text x="120" y="90" text-anchor="middle" font-size="18" font-weight="600">웹서버</text>
            <text x="120" y="115" text-anchor="middle" font-size="12" fill="#555">UPDATE user SET name = 'Bob'</text>

            <!-- 2. MySQL -->
            <rect x="380" y="60" width="200" height="80" fill="#f0fdf4" stroke="#16a34a" stroke-width="3" rx="8"/>
            <text x="480" y="90" text-anchor="middle" font-size="18" font-weight="600">MySQL</text>
            <text x="480" y="115" text-anchor="middle" font-size="12" fill="#555">트랜잭션 커밋</text>

            <!-- 3. mcsqueal (CDC) -->
            <rect x="740" y="60" width="200" height="80" fill="#fef3c7" stroke="#f59e0b" stroke-width="3" rx="8"/>
            <text x="840" y="90" text-anchor="middle" font-size="18" font-weight="600">mcsqueal (CDC)</text>
            <text x="840" y="115" text-anchor="middle" font-size="12" fill="#555">DELETE 추출</text>

            <!-- 4. mcrouter -->
            <rect x="740" y="330" width="200" height="80" fill="#f3e8ff" stroke="#a855f7" stroke-width="3" rx="8"/>
            <text x="840" y="360" text-anchor="middle" font-size="18" font-weight="600">mcrouter</text>
            <text x="840" y="385" text-anchor="middle" font-size="12" fill="#555">라우팅</text>

            <!-- 5. Frontend Clusters -->
            <rect x="20" y="330" width="200" height="80" fill="#fce7f3" stroke="#ec4899" stroke-width="3" rx="8"/>
            <text x="120" y="360" text-anchor="middle" font-size="18" font-weight="600">Frontend Clusters</text>
            <text x="120" y="385" text-anchor="middle" font-size="12" fill="#555">캐시 무효화</text>

            <!-- Arrows -->
            <defs>
                <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                    <polygon points="0 0, 10 3, 0 6" fill="#666" />
                </marker>
            </defs>

            <!-- 1 -> 2 -->
            <line x1="230" y1="100" x2="370" y2="100" stroke="#666" stroke-width="3" marker-end="url(#arrowhead)"/>
            <text x="300" y="85" text-anchor="middle" font-size="24" font-weight="600" fill="#666">SQL 전송</text>
            <text x="300" y="130" text-anchor="middle" font-size="20" fill="#555">+ DELETE user:1</text>

            <!-- 2 -> 3 -->
            <line x1="590" y1="100" x2="730" y2="100" stroke="#666" stroke-width="3" marker-end="url(#arrowhead)"/>
            <text x="660" y="85" text-anchor="middle" font-size="24" font-weight="600" fill="#666">Commit Log</text>
            <text x="660" y="130" text-anchor="middle" font-size="20" fill="#555">기록</text>

            <!-- 3 -> 4 (동그라미 피해서) -->
            <line x1="840" y1="150" x2="840" y2="270" stroke="#666" stroke-width="3" marker-end="url(#arrowhead)"/>
            <text x="930" y="215" text-anchor="middle" font-size="24" font-weight="600" fill="#666">브로드캐스트</text>
            <text x="930" y="240" text-anchor="middle" font-size="20" fill="#555">DELETE user:1</text>

            <!-- 4 -> 5 -->
            <line x1="730" y1="370" x2="230" y2="370" stroke="#666" stroke-width="3" marker-end="url(#arrowhead)"/>
            <text x="480" y="355" text-anchor="middle" font-size="24" font-weight="600" fill="#666">전달</text>
            <text x="480" y="400" text-anchor="middle" font-size="24" fill="#555">memcache.delete("user:1")</text>
        </svg>
    </div>
</body>
</html>