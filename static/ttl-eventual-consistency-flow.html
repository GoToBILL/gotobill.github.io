<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TTL 기반 최종 일관성</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #0f0f1a 0%, #1a1a2e 100%);
            min-height: 100vh;
            padding: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .container {
            width: 900px;
        }
        .card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(96, 165, 250, 0.3);
            border-radius: 24px;
            padding: 40px 50px;
        }

        .title {
            text-align: center;
            padding: 10px 24px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 30px;
            background: rgba(96, 165, 250, 0.15);
            border: 2px solid #60a5fa;
            color: #60a5fa;
        }

        .timeline {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .time-row {
            display: grid;
            grid-template-columns: 80px 1fr 140px;
            align-items: center;
            gap: 20px;
        }

        .time-label {
            font-size: 16px;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.6);
            text-align: right;
        }

        .event-box {
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
        }

        .race-condition {
            background: rgba(239, 68, 68, 0.15);
            border: 1px solid rgba(239, 68, 68, 0.4);
            color: #f87171;
        }

        .inconsistent {
            background: rgba(251, 191, 36, 0.15);
            border: 1px solid rgba(251, 191, 36, 0.4);
            color: #fbbf24;
        }

        .ttl-expire {
            background: rgba(168, 85, 247, 0.15);
            border: 1px solid rgba(168, 85, 247, 0.4);
            color: #a855f7;
        }

        .cache-miss {
            background: rgba(96, 165, 250, 0.15);
            border: 1px solid rgba(96, 165, 250, 0.4);
            color: #60a5fa;
        }

        .consistent {
            background: rgba(74, 222, 128, 0.15);
            border: 1px solid rgba(74, 222, 128, 0.4);
            color: #4ade80;
        }

        .state-box {
            display: flex;
            gap: 8px;
            align-items: center;
            justify-content: flex-end;
        }

        .state-item {
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
        }

        .db-state {
            background: rgba(74, 222, 128, 0.2);
            color: #4ade80;
        }

        .cache-old {
            background: rgba(239, 68, 68, 0.2);
            color: #f87171;
        }

        .cache-new {
            background: rgba(74, 222, 128, 0.2);
            color: #4ade80;
        }

        .cache-empty {
            background: rgba(100, 100, 100, 0.2);
            color: rgba(255, 255, 255, 0.5);
        }

        .divider {
            height: 1px;
            background: rgba(255, 255, 255, 0.1);
            margin: 12px 0;
        }

        .time-indicator {
            display: flex;
            align-items: center;
            gap: 20px;
            margin: 20px 0;
            padding-left: 100px;
        }

        .time-arrow {
            flex: 1;
            height: 3px;
            background: linear-gradient(90deg, rgba(168, 85, 247, 0.4), rgba(168, 85, 247, 1));
            position: relative;
            border-radius: 2px;
        }

        .time-arrow::after {
            content: '';
            position: absolute;
            right: -10px;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-top: 8px solid transparent;
            border-bottom: 8px solid transparent;
            border-left: 12px solid #a855f7;
        }

        .time-text {
            font-size: 16px;
            color: #a855f7;
            font-weight: 700;
        }

        .result-box {
            margin-top: 24px;
            padding: 16px 20px;
            background: rgba(74, 222, 128, 0.1);
            border: 2px solid rgba(74, 222, 128, 0.4);
            border-radius: 12px;
            text-align: center;
        }

        .result-text {
            font-size: 14px;
            font-weight: 600;
            color: #4ade80;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <div class="title">TTL 기반 최종 일관성 (Eventual Consistency)</div>

            <div class="timeline">
                <div class="time-row">
                    <div class="time-label">T1</div>
                    <div class="event-box race-condition">Race Condition 발생 - 오래된 데이터가 캐시에 저장됨</div>
                    <div class="state-box">
                        <span class="state-item db-state">DB: new</span>
                        <span class="state-item cache-old">Cache: old</span>
                    </div>
                </div>

                <div class="time-row">
                    <div class="time-label">T1 ~ T2</div>
                    <div class="event-box inconsistent">불일치 상태 유지 (TTL 만료 대기 중)</div>
                    <div class="state-box">
                        <span class="state-item db-state">DB: new</span>
                        <span class="state-item cache-old">Cache: old</span>
                    </div>
                </div>

                <div class="time-indicator">
                    <span class="time-text">5분 경과</span>
                    <div class="time-arrow"></div>
                    <span class="time-text">TTL 만료</span>
                </div>

                <div class="time-row">
                    <div class="time-label">T2</div>
                    <div class="event-box ttl-expire">캐시 자동 만료 (TTL Expired)</div>
                    <div class="state-box">
                        <span class="state-item db-state">DB: new</span>
                        <span class="state-item cache-empty">Cache: -</span>
                    </div>
                </div>

                <div class="time-row">
                    <div class="time-label">T3</div>
                    <div class="event-box cache-miss">다음 조회 시 Cache Miss - DB에서 최신 데이터 로드</div>
                    <div class="state-box">
                        <span class="state-item db-state">DB: new</span>
                        <span class="state-item cache-new">Cache: new</span>
                    </div>
                </div>

                <div class="divider"></div>

                <div class="time-row">
                    <div class="time-label">결과</div>
                    <div class="event-box consistent">일관성 회복 완료</div>
                    <div class="state-box">
                        <span class="state-item db-state">DB: new</span>
                        <span class="state-item cache-new">Cache: new</span>
                    </div>
                </div>
            </div>

            <div class="result-box">
                <span class="result-text">완벽한 즉시 일관성 대신 "TTL 시간 내 수렴"을 보장</span>
            </div>
        </div>
    </div>
</body>
</html>
